/**
 * –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –º–µ—Ç–æ–¥–æ–≤
 * –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç –º–µ–∂–¥—É —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ –º–µ—Ç–æ–¥–∞–º–∏ –Ω–∞–ø–∏—Å–∞–Ω–∏—è
 */

interface StoryContent {
  chapters: Chapter[];
  characters: Character[];
  worldSetting: WorldSetting;
  themes: string[];
  currentMethod: string;
}

interface Chapter {
  number: number;
  title: string;
  content: string;
  structuralRole?: string; // –†–æ–ª—å –≤ —Ç–µ–∫—É—â–µ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–µ
  wordCount: number;
}

interface Character {
  name: string;
  role: string;
  arc: string;
}

interface WorldSetting {
  time: string;
  place: string;
  rules: string[];
}

interface ConversionMap {
  chapters: ChapterMapping[];
  structuralNotes: string[];
  recommendations: string[];
  warnings: string[];
}

interface ChapterMapping {
  original: number[];
  target: string;
  description: string;
}

export class MethodConverter {
  /**
   * –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –º–µ—Ç–æ–¥–æ–≤
   */
  convert(content: StoryContent, targetMethod: string): ConversionMap {
    const sourceMethod = content.currentMethod;

    // –í—ã–±–æ—Ä —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –∏ —Ü–µ–ª–µ–≤–æ–≥–æ –º–µ—Ç–æ–¥–∞
    const converterKey = `${sourceMethod}_to_${targetMethod}`;

    switch (converterKey) {
      case 'three-act_to_hero-journey':
        return this.threeActToHeroJourney(content);
      case 'three-act_to_seven-point':
        return this.threeActToSevenPoint(content);
      case 'hero-journey_to_three-act':
        return this.heroJourneyToThreeAct(content);
      case 'hero-journey_to_story-circle':
        return this.heroJourneyToStoryCircle(content);
      case 'story-circle_to_three-act':
        return this.storyCircleToThreeAct(content);
      case 'seven-point_to_three-act':
        return this.sevenPointToThreeAct(content);
      default:
        return this.genericConversion(content, sourceMethod, targetMethod);
    }
  }

  /**
   * –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏–∑ —Ç—Ä–µ—Ö –∞–∫—Ç–æ–≤ –≤ –ü—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ –≥–µ—Ä–æ—è
   */
  private threeActToHeroJourney(content: StoryContent): ConversionMap {
    const totalChapters = content.chapters.length;
    const act1End = Math.floor(totalChapters * 0.25);
    const act2End = Math.floor(totalChapters * 0.75);

    const mapping: ChapterMapping[] = [
      {
        original: [1, Math.floor(act1End * 0.4)],
        target: '1. –û–±—ã—á–Ω—ã–π –º–∏—Ä',
        description: '–ü–µ—Ä–≤—ã–µ 40% –ø–µ—Ä–≤–æ–≥–æ –∞–∫—Ç–∞ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –∫–∞–∫ –æ–±—ã—á–Ω—ã–π –º–∏—Ä'
      },
      {
        original: [Math.floor(act1End * 0.4) + 1, Math.floor(act1End * 0.6)],
        target: '2. –ó–æ–≤ –∫ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è–º',
        description: '–°–æ–±—ã—Ç–∏–µ-—Ç—Ä–∏–≥–≥–µ—Ä –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∫–∞–∫ –∑–æ–≤'
      },
      {
        original: [Math.floor(act1End * 0.6) + 1, Math.floor(act1End * 0.8)],
        target: '3. –û—Ç–∫–∞–∑ –æ—Ç –∑–æ–≤–∞',
        description: '–ü–µ—Ä–∏–æ–¥ –∫–æ–ª–µ–±–∞–Ω–∏–π –≥–µ—Ä–æ—è'
      },
      {
        original: [Math.floor(act1End * 0.8) + 1, act1End],
        target: '4. –í—Å—Ç—Ä–µ—á–∞ —Å –Ω–∞—Å—Ç–∞–≤–Ω–∏–∫–æ–º',
        description: '–ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–º–æ—â–∏ –∏–ª–∏ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞'
      },
      {
        original: [act1End + 1, act1End + Math.floor((act2End - act1End) * 0.1)],
        target: '5. –ü–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ –ø–æ—Ä–æ–≥–∞',
        description: '–í—Ö–æ–¥ –≤–æ –≤—Ç–æ—Ä–æ–π –∞–∫—Ç –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∫–∞–∫ –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ –ø–æ—Ä–æ–≥–∞'
      },
      {
        original: [act1End + Math.floor((act2End - act1End) * 0.1) + 1, act1End + Math.floor((act2End - act1End) * 0.4)],
        target: '6. –ò—Å–ø—ã—Ç–∞–Ω–∏—è, —Å–æ—é–∑–Ω–∏–∫–∏ –∏ –≤—Ä–∞–≥–∏',
        description: '–ö–æ–Ω—Ñ–ª–∏–∫—Ç—ã –≤ –ø–µ—Ä–≤–æ–π –ø–æ–ª–æ–≤–∏–Ω–µ –≤—Ç–æ—Ä–æ–≥–æ –∞–∫—Ç–∞'
      },
      {
        original: [act1End + Math.floor((act2End - act1End) * 0.4) + 1, act1End + Math.floor((act2End - act1End) * 0.5)],
        target: '7. –ü—Ä–∏–±–ª–∏–∂–µ–Ω–∏–µ –∫ —Å–∞–º–æ–π –≥–ª—É–±–æ–∫–æ–π –ø–µ—â–µ—Ä–µ',
        description: '–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ –≥–ª–∞–≤–Ω–æ–º—É –∏—Å–ø—ã—Ç–∞–Ω–∏—é'
      },
      {
        original: [act1End + Math.floor((act2End - act1End) * 0.5) + 1, act1End + Math.floor((act2End - act1End) * 0.6)],
        target: '8. –ì–ª–∞–≤–Ω–æ–µ –∏—Å–ø—ã—Ç–∞–Ω–∏–µ',
        description: '–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –∫—Ä–∏–∑–∏—Å –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∫–∞–∫ –≥–ª–∞–≤–Ω–æ–µ –∏—Å–ø—ã—Ç–∞–Ω–∏–µ'
      },
      {
        original: [act1End + Math.floor((act2End - act1End) * 0.6) + 1, act1End + Math.floor((act2End - act1End) * 0.8)],
        target: '9. –û–±—Ä–µ—Ç–µ–Ω–∏–µ –Ω–∞–≥—Ä–∞–¥—ã',
        description: '–ü–æ–ª—É—á–µ–Ω–∏–µ –Ω–∞–≥—Ä–∞–¥—ã –ø–æ—Å–ª–µ –ø—Ä–µ–æ–¥–æ–ª–µ–Ω–∏—è –≥–ª–∞–≤–Ω–æ–≥–æ –∏—Å–ø—ã—Ç–∞–Ω–∏—è'
      },
      {
        original: [act1End + Math.floor((act2End - act1End) * 0.8) + 1, act2End],
        target: '10. –û–±—Ä–∞—Ç–Ω—ã–π –ø—É—Ç—å',
        description: '–ü—Ä–æ—Ü–µ—Å—Å –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏—è –≤–æ –≤—Ç–æ—Ä–æ–π –ø–æ–ª–æ–≤–∏–Ω–µ –≤—Ç–æ—Ä–æ–≥–æ –∞–∫—Ç–∞'
      },
      {
        original: [act2End + 1, act2End + Math.floor((totalChapters - act2End) * 0.6)],
        target: '11. –í–æ–∑—Ä–æ–∂–¥–µ–Ω–∏–µ',
        description: '–ö—É–ª—å–º–∏–Ω–∞—Ü–∏—è —Ç—Ä–µ—Ç—å–µ–≥–æ –∞–∫—Ç–∞ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∫–∞–∫ –≤–æ–∑—Ä–æ–∂–¥–µ–Ω–∏–µ'
      },
      {
        original: [act2End + Math.floor((totalChapters - act2End) * 0.6) + 1, totalChapters],
        target: '12. –í–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ —Å —ç–ª–∏–∫—Å–∏—Ä–æ–º',
        description: '–§–∏–Ω–∞–ª –∏ –Ω–æ–≤—ã–π –±–∞–ª–∞–Ω—Å'
      }
    ];

    const notes = [
      '–ü—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ –≥–µ—Ä–æ—è –ø–æ–¥—á–µ—Ä–∫–∏–≤–∞–µ—Ç –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π —Ä–æ—Å—Ç –ø–µ—Ä—Å–æ–Ω–∞–∂–∞, —Ç—Ä–µ–±—É–µ—Ç—Å—è —É—Å–∏–ª–∏—Ç—å –ø—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ',
      '–í–æ–∑–º–æ–∂–Ω–æ, –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∏–ª–∏ –¥–æ–±–∞–≤–∏—Ç—å —Ä–æ–ª—å –Ω–∞—Å—Ç–∞–≤–Ω–∏–∫–∞',
      '–≠—Ç–∞–ø –≥–ª–∞–≤–Ω–æ–≥–æ –∏—Å–ø—ã—Ç–∞–Ω–∏—è –¥–æ–ª–∂–µ–Ω –æ—Ç—Ä–∞–∂–∞—Ç—å —Ç–µ–º—É "—Å–º–µ—Ä—Ç–∏ –∏ –≤–æ–∑—Ä–æ–∂–¥–µ–Ω–∏—è"'
    ];

    const recommendations = [
      '–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ —á–µ—Ç–∫–æ–π —Ä–æ–ª–∏ –Ω–∞—Å—Ç–∞–≤–Ω–∏–∫–∞, –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ ‚Äî –¥–æ–±–∞–≤–∏—Ç—å',
      '–£—Å–∏–ª–∏—Ç—å –≤–Ω—É—Ç—Ä–µ–Ω–Ω—é—é –¥—É–≥—É —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏ –≥–ª–∞–≤–Ω–æ–≥–æ –≥–µ—Ä–æ—è',
      '–£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –∫–∞–∂–¥—ã–π —ç—Ç–∞–ø –ø—Ä–æ–¥–≤–∏–≥–∞–µ—Ç —Ç–µ–º—É'
    ];

    const warnings = [
      '–õ–∏–Ω–µ–π–Ω–æ–µ —Ä–∞–∑–≤–∏—Ç–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∏–∑ —Ç—Ä–µ—Ö –∞–∫—Ç–æ–≤ –º–æ–∂–µ—Ç –Ω–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å —Ü–∏–∫–ª–∏—á–µ—Å–∫–æ–π –ø—Ä–∏—Ä–æ–¥–µ –ü—É—Ç–µ—à–µ—Å—Ç–≤–∏—è –≥–µ—Ä–æ—è',
      '–ú–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–µ—Ö–æ–¥–Ω—ã—Ö –≥–ª–∞–≤'
    ];

    return { chapters: mapping, structuralNotes: notes, recommendations, warnings };
  }

  /**
   * –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏–∑ —Ç—Ä–µ—Ö –∞–∫—Ç–æ–≤ –≤ —Å–µ–º–∏—Ç–æ—á–µ—á–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É
   */
  private threeActToSevenPoint(content: StoryContent): ConversionMap {
    const totalChapters = content.chapters.length;

    const mapping: ChapterMapping[] = [
      {
        original: [1, 3],
        target: '1. –ö—Ä—é—á–æ–∫ (Hook)',
        description: '–ù–∞—á–∞–ª—å–Ω—ã–µ –≥–ª–∞–≤—ã –∫–∞–∫ –∫—Ä—é—á–æ–∫'
      },
      {
        original: [Math.floor(totalChapters * 0.25) - 1, Math.floor(totalChapters * 0.25) + 1],
        target: '2. –ü–µ—Ä–≤–∞—è –ø–æ–≤–æ—Ä–æ—Ç–Ω–∞—è —Ç–æ—á–∫–∞ (PP1)',
        description: '–ö–æ–Ω–µ—Ü –ø–µ—Ä–≤–æ–≥–æ –∞–∫—Ç–∞ –∫–∞–∫ PP1'
      },
      {
        original: [Math.floor(totalChapters * 0.375) - 1, Math.floor(totalChapters * 0.375) + 1],
        target: '3. –ü–µ—Ä–≤–∞—è —Ç–æ—á–∫–∞ —Å–∂–∞—Ç–∏—è (Pinch1)',
        description: '–¢–æ—á–∫–∞ –¥–∞–≤–ª–µ–Ω–∏—è –≤ –ø–µ—Ä–≤–æ–π –ø–æ–ª–æ–≤–∏–Ω–µ –≤—Ç–æ—Ä–æ–≥–æ –∞–∫—Ç–∞'
      },
      {
        original: [Math.floor(totalChapters * 0.5) - 1, Math.floor(totalChapters * 0.5) + 1],
        target: '4. –°–µ—Ä–µ–¥–∏–Ω–∞ (Midpoint)',
        description: '–°–µ—Ä–µ–¥–∏–Ω–∞ –∏—Å—Ç–æ—Ä–∏–∏'
      },
      {
        original: [Math.floor(totalChapters * 0.625) - 1, Math.floor(totalChapters * 0.625) + 1],
        target: '5. –í—Ç–æ—Ä–∞—è —Ç–æ—á–∫–∞ —Å–∂–∞—Ç–∏—è (Pinch2)',
        description: '–¢–æ—á–∫–∞ –¥–∞–≤–ª–µ–Ω–∏—è –≤–æ –≤—Ç–æ—Ä–æ–π –ø–æ–ª–æ–≤–∏–Ω–µ –≤—Ç–æ—Ä–æ–≥–æ –∞–∫—Ç–∞'
      },
      {
        original: [Math.floor(totalChapters * 0.75) - 1, Math.floor(totalChapters * 0.75) + 1],
        target: '6. –í—Ç–æ—Ä–∞—è –ø–æ–≤–æ—Ä–æ—Ç–Ω–∞—è —Ç–æ—á–∫–∞ (PP2)',
        description: '–ö–æ–Ω–µ—Ü –≤—Ç–æ—Ä–æ–≥–æ –∞–∫—Ç–∞ –∫–∞–∫ PP2'
      },
      {
        original: [Math.floor(totalChapters * 0.95), totalChapters],
        target: '7. –†–∞–∑–≤—è–∑–∫–∞ (Resolution)',
        description: '–ö–æ–Ω–µ—Ü —Ç—Ä–µ—Ç—å–µ–≥–æ –∞–∫—Ç–∞ –∫–∞–∫ —Ä–∞–∑–≤—è–∑–∫–∞'
      }
    ];

    const notes = [
      '–°–µ–º–∏—Ç–æ—á–µ—á–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç—Ä–µ–±—É–µ—Ç —á–µ—Ç–∫–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è —Ä–∏—Ç–º–∞',
      '–¢–æ—á–∫–∏ —Å–∂–∞—Ç–∏—è (Pinch Points) –¥–æ–ª–∂–Ω—ã –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–∏–ª—É –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫–∞',
      '–°–µ—Ä–µ–¥–∏–Ω–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –Ω–∞—Å—Ç–æ—è—â–∏–º –ø–æ–≤–æ—Ä–æ—Ç–Ω—ã–º –º–æ–º–µ–Ω—Ç–æ–º'
    ];

    const recommendations = [
      '–£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –∫–∞–∂–¥–∞—è —Ç–æ—á–∫–∞ –∏–º–µ–µ—Ç —á–µ—Ç–∫—É—é —Ñ—É–Ω–∫—Ü–∏—é',
      '–ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –ª–∏ —Å–µ—Ä–µ–¥–∏–Ω–∞ –º–µ–Ω—è–µ—Ç –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏',
      '–£—Å–∏–ª–∏—Ç—å –æ—â—É—â–µ–Ω–∏–µ –¥–∞–≤–ª–µ–Ω–∏—è –≤ —Ç–æ—á–∫–∞—Ö —Å–∂–∞—Ç–∏—è'
    ];

    const warnings = [
      '–ú–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ–ª–æ–∂–µ–Ω–∏—è –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –≥–ª–∞–≤ –¥–ª—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è —Å–µ–º–∏—Ç–æ—á–µ—á–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–µ',
      '–†–∏—Ç–º –º–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å –ø–µ—Ä–µ—Å—Ç—Ä–æ–π–∫–∏'
    ];

    return { chapters: mapping, structuralNotes: notes, recommendations, warnings };
  }

  /**
   * –ü—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ –≥–µ—Ä–æ—è –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∏–∑ —Ç—Ä–µ—Ö –∞–∫—Ç–æ–≤
   */
  private heroJourneyToThreeAct(content: StoryContent): ConversionMap {
    const mapping: ChapterMapping[] = [
      {
        original: [1, 5], // –≠—Ç–∞–ø—ã 1-5
        target: '–ü–µ—Ä–≤—ã–π –∞–∫—Ç',
        description: '–û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —ç—Ç–∞–ø–æ–≤ –æ—Ç –û–±—ã—á–Ω–æ–≥–æ –º–∏—Ä–∞ –¥–æ –ü–µ—Ä–µ—Å–µ—á–µ–Ω–∏—è –ø–æ—Ä–æ–≥–∞ –≤ –ø–µ—Ä–≤—ã–π –∞–∫—Ç'
      },
      {
        original: [6, 10], // –≠—Ç–∞–ø—ã 6-10
        target: '–í—Ç–æ—Ä–æ–π –∞–∫—Ç',
        description: '–û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —ç—Ç–∞–ø–æ–≤ –æ—Ç –ò—Å–ø—ã—Ç–∞–Ω–∏–π –¥–æ –û–±—Ä–∞—Ç–Ω–æ–≥–æ –ø—É—Ç–∏ –≤–æ –≤—Ç–æ—Ä–æ–π –∞–∫—Ç'
      },
      {
        original: [11, 12], // –≠—Ç–∞–ø—ã 11-12
        target: '–¢—Ä–µ—Ç–∏–π –∞–∫—Ç',
        description: '–û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —ç—Ç–∞–ø–æ–≤ –í–æ–∑—Ä–æ–∂–¥–µ–Ω–∏—è –∏ –í–æ–∑–≤—Ä–∞—â–µ–Ω–∏—è —Å —ç–ª–∏–∫—Å–∏—Ä–æ–º –≤ —Ç—Ä–µ—Ç–∏–π –∞–∫—Ç'
      }
    ];

    const notes = [
      '–£–ø—Ä–æ—â–µ–Ω–∏–µ 12 —ç—Ç–∞–ø–æ–≤ –¥–æ 3 –∞–∫—Ç–æ–≤',
      '–í–æ–∑–º–æ–∂–Ω–æ, –ø–æ—Ç–µ—Ä—è –≥–ª—É–±–∏–Ω—ã –¥–µ—Ç–∞–ª–µ–π',
      '–¢—Ä–µ–±—É–µ—Ç—Å—è –ø–µ—Ä–µ–æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è –ø–µ—Ä–µ—Ö–æ–¥–æ–≤'
    ];

    const recommendations = [
      '–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–ª—é—á–µ–≤—ã–µ —É–∑–ª—ã —Ä–æ—Å—Ç–∞',
      '–û–±–µ—Å–ø–µ—á–∏—Ç—å –ø–æ–¥—Ö–æ–¥—è—â–µ–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ –∞–∫—Ç–æ–≤ (25%-50%-25%)',
      '–û–±—ä–µ–¥–∏–Ω–∏—Ç—å —Å—Ö–æ–∂–∏–µ —ç—Ç–∞–ø—ã'
    ];

    const warnings = [
      '–í–æ–∑–º–æ–∂–Ω–æ, –ø–æ—Ç–µ—Ä—è–µ—Ç—Å—è —Ä–∏—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å –ü—É—Ç–µ—à–µ—Å—Ç–≤–∏—è –≥–µ—Ä–æ—è',
      '–î—É–≥–∞ —Ä–æ—Å—Ç–∞ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å —É–ø—Ä–æ—â–µ–Ω–∞'
    ];

    return { chapters: mapping, structuralNotes: notes, recommendations, warnings };
  }

  /**
   * –ü—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ –≥–µ—Ä–æ—è –≤ –∫—Ä—É–≥–æ–≤—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∏—Å—Ç–æ—Ä–∏–∏
   */
  private heroJourneyToStoryCircle(content: StoryContent): ConversionMap[] {
    const mapping: ChapterMapping[] = [
      {
        original: [1], // –û–±—ã—á–Ω—ã–π –º–∏—Ä
        target: '1. –¢—ã (–∑–æ–Ω–∞ –∫–æ–º—Ñ–æ—Ä—Ç–∞)',
        description: '–û–±—ã—á–Ω—ã–π –º–∏—Ä = –∑–æ–Ω–∞ –∫–æ–º—Ñ–æ—Ä—Ç–∞'
      },
      {
        original: [2, 3], // –ó–æ–≤ + –û—Ç–∫–∞–∑
        target: '2. –ü–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç—å',
        description: '–ó–æ–≤ –ø–æ—Ä–æ–∂–¥–∞–µ—Ç –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç—å'
      },
      {
        original: [4, 5], // –ù–∞—Å—Ç–∞–≤–Ω–∏–∫ + –ü–æ—Ä–æ–≥
        target: '3. –í—Ö–æ–¥',
        description: '–ü–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ –ø–æ—Ä–æ–≥–∞ –≤–µ–¥–µ—Ç –≤ –Ω–æ–≤—ã–π –º–∏—Ä'
      },
      {
        original: [6, 7], // –ò—Å–ø—ã—Ç–∞–Ω–∏—è + –ü–µ—â–µ—Ä–∞
        target: '4. –ü–æ–∏—Å–∫',
        description: '–ü—Ä–æ—Ü–µ—Å—Å –∏—Å–ø—ã—Ç–∞–Ω–∏–π ‚Äî —ç—Ç–æ –ø–æ–∏—Å–∫'
      },
      {
        original: [8, 9], // –ì–ª–∞–≤–Ω–æ–µ –∏—Å–ø—ã—Ç–∞–Ω–∏–µ + –ù–∞–≥—Ä–∞–¥–∞
        target: '5. –ù–∞—Ö–æ–¥–∫–∞',
        description: '–ü–æ–ª—É—á–µ–Ω–∏–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–≥–æ –ø–æ—Å–ª–µ –ø—Ä–µ–æ–¥–æ–ª–µ–Ω–∏—è –≥–ª–∞–≤–Ω–æ–≥–æ –∏—Å–ø—ã—Ç–∞–Ω–∏—è'
      },
      {
        original: [10], // –û–±—Ä–∞—Ç–Ω—ã–π –ø—É—Ç—å
        target: '6. –¶–µ–Ω–∞',
        description: '–¶–µ–Ω–∞, –∑–∞–ø–ª–∞—á–µ–Ω–Ω–∞—è –Ω–∞ –æ–±—Ä–∞—Ç–Ω–æ–º –ø—É—Ç–∏'
      },
      {
        original: [11], // –í–æ–∑—Ä–æ–∂–¥–µ–Ω–∏–µ
        target: '7. –í–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ',
        description: '–í–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ –ø–æ—Å–ª–µ –≤–æ–∑—Ä–æ–∂–¥–µ–Ω–∏—è'
      },
      {
        original: [12], // –í–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ —Å —ç–ª–∏–∫—Å–∏—Ä–æ–º
        target: '8. –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è',
        description: '–ü–æ–ª–Ω–∞—è —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è'
      }
    ];

    const notes = [
      '–ö—Ä—É–≥–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏—Å—Ç–æ—Ä–∏–∏ –±–æ–ª—å—à–µ –ø–æ–¥—á–µ—Ä–∫–∏–≤–∞–µ—Ç —Ü–∏–∫–ª–∏—á–Ω–æ—Å—Ç—å',
      '–£–ø—Ä–æ—â–∞–µ—Ç —Å–ª–æ–∂–Ω–æ—Å—Ç—å –ü—É—Ç–µ—à–µ—Å—Ç–≤–∏—è –≥–µ—Ä–æ—è',
      '–ë–æ–ª—å—à–µ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –∫–æ—Ä–æ—Ç–∫–∏—Ö —Ä–∞—Å—Å–∫–∞–∑–æ–≤ –∏–ª–∏ —Å–µ—Ä–∏–π –∏—Å—Ç–æ—Ä–∏–π'
    ];

    const recommendations = [
      '–ü–æ–¥—á–µ—Ä–∫–Ω—É—Ç—å –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–∏ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞',
      '–ß–µ—Ç–∫–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø—Ä–∏—á–∏–Ω–Ω–æ-—Å–ª–µ–¥—Å—Ç–≤–µ–Ω–Ω—ã–µ —Å–≤—è–∑–∏ –∫–∞–∂–¥–æ–≥–æ —à–∞–≥–∞',
      '–†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Ü–∏–∫–ª–∏—á–Ω–æ—Å—Ç–∏'
    ];

    const warnings = [
      '–ú–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è —É–ø—Ä–æ—â–µ–Ω–∏–µ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Å–ª–æ–∂–Ω—ã—Ö —Å—é–∂–µ—Ç–æ–≤',
      '–≠–ø–∏—á–Ω–æ—Å—Ç—å –º–æ–∂–µ—Ç —É–º–µ–Ω—å—à–∏—Ç—å—Å—è'
    ];

    return { chapters: mapping, structuralNotes: notes, recommendations, warnings };
  }

  /**
   * –ö—Ä—É–≥–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏—Å—Ç–æ—Ä–∏–∏ –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∏–∑ —Ç—Ä–µ—Ö –∞–∫—Ç–æ–≤
   */
  private storyCircleToThreeAct(content: StoryContent): ConversionMap {
    const mapping: ChapterMapping[] = [
      {
        original: [1, 2], // –¢—ã + –ü–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç—å
        target: '–ü–µ—Ä–≤—ã–π –∞–∫—Ç',
        description: '–£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏ —Ç—Ä–∏–≥–≥–µ—Ä'
      },
      {
        original: [3, 4, 5, 6], // –í—Ö–æ–¥ + –ü–æ–∏—Å–∫ + –ù–∞—Ö–æ–¥–∫–∞ + –¶–µ–Ω–∞
        target: '–í—Ç–æ—Ä–æ–π –∞–∫—Ç',
        description: '–ü—Ä–∏–∫–ª—é—á–µ–Ω–∏—è –∏ –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã'
      },
      {
        original: [7, 8], // –í–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ + –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è
        target: '–¢—Ä–µ—Ç–∏–π –∞–∫—Ç',
        description: '–†–µ—à–µ–Ω–∏–µ –∏ –Ω–æ–≤—ã–π –±–∞–ª–∞–Ω—Å'
      }
    ];

    const notes = [
      '–£–ø—Ä–æ—â–µ–Ω–∏–µ 8 —à–∞–≥–æ–≤ –¥–æ 3 –∞–∫—Ç–æ–≤',
      '–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞',
      '–ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ä–∏—Ç–º–∞'
    ];

    const recommendations = [
      '–£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –≤—Ç–æ—Ä–æ–π –∞–∫—Ç –Ω–µ –∑–∞—Ç—è–Ω—É—Ç',
      '–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏',
      '–ß–µ—Ç–∫–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏ —Ç—Ä–µ—Ö –∞–∫—Ç–æ–≤'
    ];

    const warnings = [
      '–í–æ–∑–º–æ–∂–Ω–æ, –ø–æ—Ç–µ—Ä—è–µ—Ç—Å—è –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å —Ü–∏–∫–ª–∏—á–µ—Å–∫–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã',
      '–¢—Ä–µ–±—É–µ—Ç—Å—è –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∞ —Ä–∏—Ç–º–∞'
    ];

    return { chapters: mapping, structuralNotes: notes, recommendations, warnings };
  }

  /**
   * –°–µ–º–∏—Ç–æ—á–µ—á–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∏–∑ —Ç—Ä–µ—Ö –∞–∫—Ç–æ–≤
   */
  private sevenPointToThreeAct(content: StoryContent): ConversionMap {
    const mapping: ChapterMapping[] = [
      {
        original: [1, 2], // –ö—Ä—é—á–æ–∫ + PP1
        target: '–ü–µ—Ä–≤—ã–π –∞–∫—Ç',
        description: '–û—Ç –ö—Ä—é—á–∫–∞ –¥–æ –ø–µ—Ä–≤–æ–π –ø–æ–≤–æ—Ä–æ—Ç–Ω–æ–π —Ç–æ—á–∫–∏'
      },
      {
        original: [3, 4, 5, 6], // Pinch1 + Mid + Pinch2 + PP2
        target: '–í—Ç–æ—Ä–æ–π –∞–∫—Ç',
        description: '–í—Å–µ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ —Ç–æ—á–∫–∏'
      },
      {
        original: [7], // –†–∞–∑–≤—è–∑–∫–∞
        target: '–¢—Ä–µ—Ç–∏–π –∞–∫—Ç',
        description: '–ß–∞—Å—Ç—å —Ä–∞–∑–≤—è–∑–∫–∏'
      }
    ];

    const notes = [
      '–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–ª—é—á–µ–≤—ã—Ö –ø–æ–≤–æ—Ä–æ—Ç–Ω—ã—Ö —Ç–æ—á–µ–∫',
      '–£–ø—Ä–æ—â–µ–Ω–∏–µ —Ç–æ—á–µ–∫ –¥–æ –∞–∫—Ç–æ–≤',
      '–ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –ø–µ—Ä–µ—Ö–æ–¥–æ–≤'
    ];

    const recommendations = [
      '–£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –ø–æ–≤–æ—Ä–æ—Ç–Ω—ã–µ —Ç–æ—á–∫–∏ –æ—Å—Ç–∞—é—Ç—Å—è —á–µ—Ç–∫–∏–º–∏',
      '–ù–µ —Ç–µ—Ä—è—Ç—å —á—É–≤—Å—Ç–≤–æ —Ä–∏—Ç–º–∞',
      '–°–æ—Ö—Ä–∞–Ω—è—Ç—å –∫—Ä–∏–≤—É—é –Ω–∞–ø—Ä—è–∂–µ–Ω–∏—è'
    ];

    const warnings = [
      '–í–æ–∑–º–æ–∂–Ω–æ, –ø–æ—Ç–µ—Ä—è–µ—Ç—Å—è —Ç–æ—á–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å —Ä–∏—Ç–º–∞',
      '–¢—Ä–µ–±—É–µ—Ç—Å—è –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–µ—Ä–µ—Ö–æ–¥–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞'
    ];

    return { chapters: mapping, structuralNotes: notes, recommendations, warnings };
  }

  /**
   * –û–±—â–µ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –¥–ª—è –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –ø–∞—Ä –º–µ—Ç–æ–¥–æ–≤
   */
  private genericConversion(content: StoryContent, sourceMethod: string, targetMethod: string): ConversionMap {
    // –ó–¥–µ—Å—å –º–æ–∂–µ—Ç –±—ã—Ç—å –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω–∞—è –ª–æ–≥–∏–∫–∞ –∏–ª–∏ –≤—ã–∑–æ–≤ –≤–Ω–µ—à–Ω–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
    // –î–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –ø—É—Å—Ç—É—é –∫–∞—Ä—Ç—É —Å –æ–±—â–∏–º–∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏
    const mapping: ChapterMapping[] = [];

    const notes = [
      `–ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –∏–∑ "${sourceMethod}" –≤ "${targetMethod}" –Ω–µ –∏–º–µ–µ—Ç —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–æ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏.`,
      '–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—Ä—É—á–Ω—É—é –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∏ –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å –µ–µ.'
    ];

    const recommendations = [
      '–ò–∑—É—á–∏—Ç–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ü–µ–ª–µ–≤–æ–≥–æ –º–µ—Ç–æ–¥–∞.',
      '–û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ –∫–ª—é—á–µ–≤—ã–µ —Ç–æ—á–∫–∏ –∏ —Å–æ–±—ã—Ç–∏—è –≤ –∏—Å—Ö–æ–¥–Ω–æ–º –∫–æ–Ω—Ç–µ–Ω—Ç–µ.',
      '–í—Ä—É—á–Ω—É—é —Å–æ–ø–æ—Å—Ç–∞–≤—å—Ç–µ —ç—Ç–∏ —Ç–æ—á–∫–∏ —Å –Ω–æ–≤–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π.'
    ];

    const warnings = [
      '–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ—Ç–æ—á–Ω—ã–º –∏–ª–∏ –Ω–µ–≤–æ–∑–º–æ–∂–Ω—ã–º.',
      '–¢—Ä–µ–±—É–µ—Ç—Å—è –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ–µ —Ä—É—á–Ω–æ–µ –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–æ.'
    ];

    return { chapters: mapping, structuralNotes: notes, recommendations, warnings };
  }
}

    return { chapters: mapping, structuralNotes: notes, recommendations, warnings };
  }

  /**
   * –û–±—â–µ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ (–ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö –ø—Ä–∞–≤–∏–ª)
   */
  private genericConversion(content: StoryContent, source: string, target: string): ConversionMap {
    const totalChapters = content.chapters.length;

    // –û–±—â–µ–µ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–æ—Ü–µ–Ω—Ç–æ–≤
    const mapping: ChapterMapping[] = [
      {
        original: [1, Math.floor(totalChapters * 0.25)],
        target: '–ù–∞—á–∞–ª–æ/–ó–∞–≤—è–∑–∫–∞',
        description: '–≠—Ç–∞–ø –∑–∞–≤—è–∑–∫–∏ –∏—Å—Ç–æ—Ä–∏–∏'
      },
      {
        original: [Math.floor(totalChapters * 0.25) + 1, Math.floor(totalChapters * 0.75)],
        target: '–†–∞–∑–≤–∏—Ç–∏–µ/–ö–æ–Ω—Ñ–ª–∏–∫—Ç',
        description: '–û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ñ–ª–∏–∫—Ç –∏ —Ä–∞–∑–≤–∏—Ç–∏–µ'
      },
      {
        original: [Math.floor(totalChapters * 0.75) + 1, totalChapters],
        target: '–ö—É–ª—å–º–∏–Ω–∞—Ü–∏—è/–§–∏–Ω–∞–ª',
        description: '–ö—É–ª—å–º–∏–Ω–∞—Ü–∏—è –∏ —Ä–∞–∑–≤—è–∑–∫–∞'
      }
    ];

    const notes = [
      `–ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –∏–∑ ${this.getMethodName(source)} –≤ ${this.getMethodName(target)}`,
      '–≠—Ç–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ –æ–±—â–∏—Ö –ø—Ä–∞–≤–∏–ª',
      '–ú–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è —Ä—É—á–Ω–∞—è –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞'
    ];

    const recommendations = [
      '–¢—â–∞—Ç–µ–ª—å–Ω–æ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É',
      '–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—è–º–∏ —Ü–µ–ª–µ–≤–æ–≥–æ –º–µ—Ç–æ–¥–∞',
      '–†–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∏–ª–∏ —É–¥–∞–ª–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞'
    ];

    const warnings = [
      '–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ—Ç–æ—á–Ω—ã–º',
      '–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —Ä—É—á–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∏ –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞',
      '–ù–µ–∫–æ—Ç–æ—Ä—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –º–æ–≥—É—Ç –±—ã—Ç—å —É—Ç–µ—Ä—è–Ω—ã –ø—Ä–∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–∏'
    ];

    return { chapters: mapping, structuralNotes: notes, recommendations, warnings };
  }

  /**
   * –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–∞ –æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–∏
   */
  generateConversionReport(content: StoryContent, targetMethod: string): string {
    const conversionMap = this.convert(content, targetMethod);

    let report = `# üìù –û—Ç—á–µ—Ç –æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–∏ –º–µ—Ç–æ–¥–∞\n\n`;
    report += `## –°–≤–æ–¥–∫–∞ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è\n`;
    report += `- **–ò—Å—Ö–æ–¥–Ω—ã–π –º–µ—Ç–æ–¥**Ôºö${this.getMethodName(content.currentMethod)}\n`;
    report += `- **–¶–µ–ª–µ–≤–æ–π –º–µ—Ç–æ–¥**Ôºö${this.getMethodName(targetMethod)}\n`;
    report += `- **–û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≥–ª–∞–≤**Ôºö${content.chapters.length} –≥–ª–∞–≤\n`;
    report += `- **–û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–ª–æ–≤**Ôºö${content.chapters.reduce((sum, ch) => sum + ch.wordCount, 0)} —Å–ª–æ–≤\n\n`;

    report += `## üìä –°–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –≥–ª–∞–≤\n\n`;
    report += `| –ò—Å—Ö–æ–¥–Ω—ã–µ –≥–ª–∞–≤—ã | –¶–µ–ª–µ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |\n`;
    report += `|----------------|-------------------|----------|\n`;
    conversionMap.chapters.forEach(mapping => {
      const range = mapping.original.length === 2
        ? `${mapping.original[0]}-${mapping.original[1]}`
        : `${mapping.original[0]}`;
      report += `| –ì–ª–∞–≤—ã ${range} | ${mapping.target} | ${mapping.description} |\n`;
    });

    report += `\n## üìå –°—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–µ –ø—Ä–∏–º–µ—á–∞–Ω–∏—è\n`;
    conversionMap.structuralNotes.forEach(note => {
      report += `- ${note}\n`;
    });

    report += `\n## ‚úÖ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏\n`;
    conversionMap.recommendations.forEach(rec => {
      report += `- ${rec}\n`;
    });

    if (conversionMap.warnings.length > 0) {
      report += `\n## ‚ö†Ô∏è –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è\n`;
      conversionMap.warnings.forEach(warning => {
        report += `- ${warning}\n`;
      });
    }

    report += `\n## üîß –î–∞–ª—å–Ω–µ–π—à–∏–µ —à–∞–≥–∏\n`;
    report += `1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∞–¥–µ–∫–≤–∞—Ç–Ω–æ—Å—Ç—å —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è –≥–ª–∞–≤\n`;
    report += `2. –°–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ –≥–ª–∞–≤ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –Ω–æ–≤–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π\n`;
    report += `3. –î–æ–±–∞–≤–∏—Ç—å –∏–ª–∏ —É–¥–∞–ª–∏—Ç—å –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–π –ø–µ—Ä–µ—Ö–æ–¥–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç\n`;
    report += `4. –û–±–µ—Å–ø–µ—á–∏—Ç—å —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –Ω–æ–≤–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã\n`;
    report += `5. –ü—Ä–æ–≤–µ—Å—Ç–∏ —Ç–µ—Å—Ç–æ–≤–æ–µ —á—Ç–µ–Ω–∏–µ\n`;

    return report;
  }

  /**
   * –ü–æ–ª—É—á–∏—Ç—å –∫–∏—Ç–∞–π—Å–∫–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –º–µ—Ç–æ–¥–∞
   */
  private getMethodName(method: string): string {
    const names: Record<string, string> = {
      'three-act': '–¢—Ä—ë—Ö–∞–∫—Ç–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞',
      'hero-journey': '–ü—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ –≥–µ—Ä–æ—è',
      'story-circle': '–ö—Ä—É–≥ –∏—Å—Ç–æ—Ä–∏–∏',
      'seven-point': '–°–µ–º–∏—Ç–æ—á–µ—á–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞',
      'pixar-formula': '–§–æ—Ä–º—É–ª–∞ –ü–∏–∫—Å–∞—Ä'
    };
    return names[method] || method;
  }
}