---
name: track-init
description: Инициализация системы отслеживания на основе данных трекера, установленных по плану истории
allowed-tools: Read(//stories/**/specification.md), Read(stories/**/specification.md), Read(//stories/**/outline.md), Read(stories/**/outline.md), Read(//stories/**/creative-plan.md), Read(stories/**/creative-plan.md), Write(//spec/tracking/**), Write(spec/tracking/**), Bash(find:*), Bash(grep:*), Bash(wc:*), Bash(*)
model: claude-sonnet-4-5-20250929
scripts:
  sh: .specify/scripts/bash/init-tracking.sh
  ps: .specify/scripts/powershell/init-tracking.ps1
---

# Инициализация системы отслеживания

На основе созданного плана истории и планирования глав инициализируются все файлы данных отслеживания.

## Когда использовать

Выполните эту команду после завершения `/story` и `/outline`, перед началом написания.

## Процесс инициализации

1. **Чтение базовых данных**
   - Чтение `stories/*/story.md` для получения сеттинга истории
   - Чтение `stories/*/outline.md` для получения плана глав
   - Чтение `.specify/config.json` для получения метода написания

2. **Инициализация файлов отслеживания**

   **Важно**: В первую очередь прочитайте спецификацию управления сюжетными линиями из пятой главы `specification.md` и заполните ею файлы отслеживания.

   Создание или обновление `spec/tracking/plot-tracker.json`:
   - Чтение всех определений сюжетных линий из `specification.md, раздел 5.1`
   - Чтение всех точек пересечения из `specification.md, раздел 5.3`
   - Чтение всех заделов из `specification.md, раздел 5.4`
   - Чтение распределения сюжетных линий по главам из `creative-plan.md`
   - Установка текущего состояния (предполагая, что написание ещё не началось)

   **Структура `plot-tracker.json`**:
   ```json
   {
     "novel": "[Название истории, прочитанное из specification.md]",
     "lastUpdated": "[YYYY-MM-DD]",
     "currentState": {
       "chapter": 0,
       "volume": 1,
       "mainPlotStage": "[Начальная стадия]"
     },
     "plotlines": {
       "main": {
         "name": "[Название основной линии]",
         "status": "active",
         "currentNode": "[Стартовая точка]",
         "completedNodes": [],
         "upcomingNodes": "[Прочитано из точек пересечения и плана глав]"
       },
       "subplots": [
         {
           "id": "[Прочитано из 5.1, например PL-01]",
           "name": "[Название сюжетной линии]",
           "type": "[Основная линия/Побочная линия/Поддержка основной линии]",
           "priority": "[P0/P1/P2]",
           "status": "[active/dormant]",
           "plannedStart": "[Глава начала]",
           "plannedEnd": "[Глава окончания]",
           "currentNode": "[Текущий узел]",
           "completedNodes": [],
           "upcomingNodes": "[Прочитано из таблицы точек пересечения]",
           "intersectionsWith": "[Связанные линии, прочитанные из таблицы пересечений 5.3]",
           "activeChapters": "[Прочитано из плана ритма 5.2]"
         }
       ]
     },
     "foreshadowing": [
       {
         "id": "[Прочитано из 5.4, например F-001]",
         "content": "[Содержание задела]",
         "planted": {"chapter": null, "description": "[Описание внедрения]"},
         "hints": [],
         "plannedReveal": {"chapter": "[Глава раскрытия]", "description": "[Способ раскрытия]"},
         "status": "planned",
         "importance": "[high/medium/low]",
         "relatedPlotlines": "[Список ID связанных сюжетных линий]"
       }
     ],
     "intersections": [
       {
         "id": "[Прочитано из 5.3, например X-001]",
         "chapter": "[Глава пересечения]",
         "plotlines": "[Список ID задействованных сюжетных линий]",
         "content": "[Содержание пересечения]",
         "status": "upcoming",
         "impact": "[Ожидаемый эффект]"
       }
     ]
   }
   ```

   Создание или обновление `spec/tracking/timeline.json`:
   - Установка временных точек на основе плана глав
   - Отметка важных временных событий

   Создание или обновление `spec/tracking/relationships.json`:
   - Извлечение начальных отношений из сеттинга персонажей
   - Группировка по фракциям

   Создание или обновление `spec/tracking/character-state.json`:
   - Инициализация состояния персонажей
   - Установка начального местоположения

3. **Генерация отчёта отслеживания**
   Отображение результатов инициализации, подтверждение готовности системы отслеживания

## Интеллектуальная связь

- Автоматическая установка контрольных точек в соответствии с методом написания
- Путешествие героя: точки отслеживания по 12 стадиям
- Трёхактная структура: точки поворота актов
- Семиточечная структура: 7 ключевых узлов

После инициализации системы отслеживания, последующее написание будет автоматически обновлять эти данные.