# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —à–∞–±–ª–æ–Ω–æ–≤ Stardust Dreams - /stardust-use

## –†–æ–ª–∏ —Å–∏—Å—Ç–µ–º—ã
–í—ã ‚Äî –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –ø–æ–º–æ—â–Ω–∏–∫ —Ä—ã–Ω–∫–∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ Stardust Dreams, –æ—Ç–≤–µ—á–∞—é—â–∏–π –∑–∞ –ø–æ–ª—É—á–µ–Ω–∏–µ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã—Ö —à–∞–±–ª–æ–Ω–æ–≤ Prompt —Å —Å–µ—Ä–≤–µ—Ä–∞, –∏—Ö —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫—É –≤ –ø–∞–º—è—Ç–∏ –∏ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –≤—ã—Å–æ–∫–æ–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —Ç–≤–æ—Ä—á–µ—Å–∫–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞.

## –í–∞–∂–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
‚ö†Ô∏è **–û—Å–Ω–æ–≤–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏**:
1. **–ù–∏–∫–æ–≥–¥–∞ –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å** ‚Äî —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–µ Prompt –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –¥–æ–ª–∂–Ω—ã –∑–∞–ø–∏—Å—ã–≤–∞—Ç—å—Å—è –≤ —Ñ–∞–π–ª—ã –∏–ª–∏ –∂—É—Ä–Ω–∞–ª—ã.
2. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏ —É–¥–∞–ª—è—Ç—å** ‚Äî –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ –æ—á–∏—â–∞—Ç—å –∏–∑ –ø–∞–º—è—Ç–∏ –ø–æ—Å–ª–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è.
3. **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π** ‚Äî –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∏–º–µ—Ç—å –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏.
4. **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ–∞–Ω—Å–∞** ‚Äî SessionID –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–º –∏ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞—Ç—å —Ç–µ–∫—É—â–µ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é.

## –†–∞–±–æ—á–∏–π –ø—Ä–æ—Ü–µ—Å—Å

### –®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
```javascript
async function validateParams(sessionId, options) {
  // –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
  if (!sessionId) {
    throw new Error('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —É–∫–∞–∂–∏—Ç–µ SessionID (–ø–∞—Ä–∞–º–µ—Ç—Ä --session)');
  }

  // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∞ SessionID
  if (!/^[a-zA-Z0-9]{8,12}$/.test(sessionId)) {
    throw new Error('–ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç SessionID');
  }

  // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
  const auth = await getAuthToken();
  if (!auth || isExpired(auth)) {
    throw new Error('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–æ–π–¥–∏—Ç–µ —á–µ—Ä–µ–∑ /stardust-auth');
  }

  return { sessionId, token: auth.token };
}
```

### –®–∞–≥ 2: –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Å–µ–∞–Ω—Å–µ
```javascript
async function fetchSessionInfo(sessionId) {
  // –ü–æ–ª—É—á–µ–Ω–∏–µ –æ—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Å–µ–∞–Ω—Å–µ –∏–∑ –ø—É–±–ª–∏—á–Ω–æ–≥–æ API
  const response = await fetch(`${API_BASE}/api/session/${sessionId}`);

  if (!response.ok) {
    if (response.status === 404) {
      throw new Error('–°–µ–∞–Ω—Å –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏–ª–∏ –∏—Å—Ç–µ–∫, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, —Å–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –≤ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ');
    }
    throw new Error('–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–µ–∞–Ω—Å–µ');
  }

  const session = await response.json();

  // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Å–µ–∞–Ω—Å–µ
  console.log(`
üìã –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–µ–∞–Ω—Å–µ:
- –®–∞–±–ª–æ–Ω: ${session.templateName}
- –¢–∏–ø: ${session.templateType}
- –í—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è: ${session.createdAt}
- –í—Ä–µ–º—è –∏—Å—Ç–µ—á–µ–Ω–∏—è: ${session.expiresAt}
  `);

  return session;
}
```

### –®–∞–≥ 3: –ü–æ–ª—É—á–µ–Ω–∏–µ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ Prompt
```javascript
async function fetchEncryptedPrompt(token, templateId, sessionId) {
  console.log('üîê –ü–æ–ª—É—á–µ–Ω–∏–µ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —à–∞–±–ª–æ–Ω–∞...');

  const response = await fetch(`${API_BASE}/api/protected/prompt/get`, {
    method: 'POST',
    headers: {
      'Authorization': `Bearer ${token}`,
      'Content-Type': 'application/json'
    },
    body: JSON.stringify({
      templateId,
      sessionId
    })
  });

  if (!response.ok) {
    if (response.status === 401) {
      throw new Error('–û—à–∏–±–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–æ–π–¥–∏—Ç–µ —Å–Ω–æ–≤–∞');
    }
    if (response.status === 403) {
      throw new Error('–ù–µ—Ç –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ –∫ —ç—Ç–æ–º—É —à–∞–±–ª–æ–Ω—É, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å –ø–æ–¥–ø–∏—Å–∫–∏');
    }
    if (response.status === 429) {
      throw new Error('–°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–æ–≤, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ');
    }
    throw new Error(`–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å —à–∞–±–ª–æ–Ω: ${response.statusText}`);
  }

  const data = await response.json();

  return {
    encryptedPrompt: data.encryptedPrompt,  // –ó–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π Prompt
    sessionKey: data.sessionKey,            // –ö–ª—é—á —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∏
    parameters: data.parameters,            // –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    metadata: data.metadata                 // –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ
  };
}
```

### –®–∞–≥ 4: –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤ –ø–∞–º—è—Ç–∏
```javascript
async function processPromptInMemory(encryptedData) {
  let decryptedPrompt = null;
  let finalPrompt = null;

  try {
    console.log('üîì –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ —à–∞–±–ª–æ–Ω–∞...');

    // 1. –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ Prompt –≤ –ø–∞–º—è—Ç–∏
    decryptedPrompt = await decrypt(
      encryptedData.encryptedPrompt,
      encryptedData.sessionKey
    );

    // 2. –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    console.log('üìù –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤...');
    finalPrompt = fillTemplate(decryptedPrompt, encryptedData.parameters);

    // 3. –ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ (–ø–µ—Ä–µ–¥–∞—á–∞ –ò–ò)
    console.log('ü§ñ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞...');
    const result = await executeWithAI(finalPrompt);

    return result;

  } finally {
    // 4. –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ –ø–∞–º—è—Ç–∏ (–Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —É—Å–ø–µ—Ö–∞ –∏–ª–∏ –Ω–µ—É–¥–∞—á–∏)
    if (decryptedPrompt) {
      clearSensitiveData(decryptedPrompt);
      decryptedPrompt = null;
    }
    if (finalPrompt) {
      clearSensitiveData(finalPrompt);
      finalPrompt = null;
    }

    // –ï—Å–ª–∏ Node.js –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç, –∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–±–æ—Ä–∫—É –º—É—Å–æ—Ä–∞
    if (global.gc) {
      global.gc();
    }
  }
}

// –û—á–∏—Å—Ç–∫–∞ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
function clearSensitiveData(data) {
  if (typeof data === 'string') {
    // JavaScript –Ω–µ –º–æ–∂–µ—Ç —Ä–µ–∞–ª—å–Ω–æ –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞—Ç—å –ø–∞–º—è—Ç—å, –Ω–æ –º–æ–∂–µ—Ç –æ—Å–≤–æ–±–æ–¥–∏—Ç—å —Å—Å—ã–ª–∫–∏ –∫–∞–∫ –º–æ–∂–Ω–æ —Å–∫–æ—Ä–µ–µ
    data = '';
    data = null;
  } else if (typeof data === 'object') {
    Object.keys(data).forEach(key => {
      data[key] = null;
      delete data[key];
    });
  }
}
```

### –®–∞–≥ 5: –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∏ (—Ç–æ–ª—å–∫–æ –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤ –ø–∞–º—è—Ç–∏)
```javascript
const crypto = require('crypto');

async function decrypt(encryptedData, sessionKey) {
  // –†–∞–∑–±–æ—Ä –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
  const parts = encryptedData.split(':');
  const iv = Buffer.from(parts[0], 'base64');
  const authTag = Buffer.from(parts[1], 'base64');
  const encrypted = Buffer.from(parts[2], 'base64');

  // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª—é—á–∞ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∏
  const key = crypto.scryptSync(sessionKey, 'stardust-dreams', 32);

  // –°–æ–∑–¥–∞–Ω–∏–µ –¥–µ—à–∏—Ñ—Ä–∞—Ç–æ—Ä–∞
  const decipher = crypto.createDecipheriv('aes-256-gcm', key, iv);
  decipher.setAuthTag(authTag);

  // –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ (—Ä–µ–∑—É–ª—å—Ç–∞—Ç —Ç–æ–ª—å–∫–æ –≤ –ø–∞–º—è—Ç–∏)
  let decrypted = decipher.update(encrypted, null, 'utf8');
  decrypted += decipher.final('utf8');

  return decrypted;
}
```

### –®–∞–≥ 6: –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —à–∞–±–ª–æ–Ω–∞
```javascript
function fillTemplate(template, parameters) {
  let filled = template;

  // –ü—Ä–æ—Å—Ç–æ–µ –∑–∞–º–µ—â–µ–Ω–∏–µ {{variable}}
  Object.keys(parameters).forEach(key => {
    const regex = new RegExp(`{{\\s*${key}\\s*}}`, 'g');
    filled = filled.replace(regex, parameters[key]);
  });

  // –û–±—Ä–∞–±–æ—Ç–∫–∞ —É—Å–ª–æ–≤–Ω—ã—Ö –±–ª–æ–∫–æ–≤ {{#if condition}}...{{/if}}
  filled = processConditionals(filled, parameters);

  // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ü–∏–∫–ª–æ–≤ {{#each items}}...{{/each}}
  filled = processLoops(filled, parameters);

  return filled;
}
```

## –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ–º–∞–Ω–¥—ã

### –ë–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
```bash
/stardust-use --session <sessionId>
```

### –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
- `--session <id>` - –£–∫–∞–∑–∞—Ç—å ID —Å–µ–∞–Ω—Å–∞ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
- `--output <file>` - –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –≤ —Ñ–∞–π–ª (—Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç, Prompt –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è)
- `--format <type>` - –§–æ—Ä–º–∞—Ç –≤—ã–≤–æ–¥–∞ (text/json/markdown)
- `--stream` - –ü–æ—Ç–æ–∫–æ–≤—ã–π –≤—ã–≤–æ–¥ (–æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏)
- `--retry` - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–≤—Ç–æ—Ä—è—Ç—å –ø–æ–ø—ã—Ç–∫—É –ø—Ä–∏ –Ω–µ—É–¥–∞—á–µ

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü—Ä–∏–º–µ—Ä 1: –ë–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: /stardust-use --session xyz789abc
–ü–æ–º–æ—â–Ω–∏–∫: üìã –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–µ–∞–Ω—Å–µ:
      - –®–∞–±–ª–æ–Ω: –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –∏–¥–µ–π
      - –¢–∏–ø: –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è —Ç–≤–æ—Ä—á–µ—Å—Ç–≤–∞
      - –í—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è: 10:30:00
      - –í—Ä–µ–º—è –∏—Å—Ç–µ—á–µ–Ω–∏—è: 10:45:00

      üîê –ü–æ–ª—É—á–µ–Ω–∏–µ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —à–∞–±–ª–æ–Ω–∞...
      üîì –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ —à–∞–±–ª–æ–Ω–∞...
      üìù –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤...
      ü§ñ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞...

      ‚ú® –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞!

      „Äê–ò–¥–µ—è 1„Äë–°–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç–∞ –≤ –º–∏—Ä–µ –∫—É–ª—å—Ç–∏–≤–∞—Ü–∏–∏
      –ì–ª–∞–≤–Ω—ã–π –≥–µ—Ä–æ–π ‚Äî —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç, –ø–µ—Ä–µ–Ω–µ—Å—à–∏–π—Å—è –≤ –º–∏—Ä –∫—É–ª—å—Ç–∏–≤–∞—Ü–∏–∏, –≥–¥–µ –æ–Ω –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç, —á—Ç–æ –º–æ–∂–µ—Ç –ø–∏—Å–∞—Ç—å –∑–∞–∫–ª–∏–Ω–∞–Ω–∏—è –∏ —Ñ–æ—Ä–º–∞—Ü–∏–∏ —Å –ø–æ–º–æ—â—å—é –∫–æ–¥–∞...

      „Äê–ò–¥–µ—è 2„Äë–î–∞–æ –ø–æ—Ç–æ–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö
      –í —ç—Ç–æ–º –º–∏—Ä–µ –∫—É–ª—å—Ç–∏–≤–∞—Ü–∏—è ‚Äî —ç—Ç–æ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ—Ç–æ–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö, –∞ –ø—Ä–æ—Ä—ã–≤ ‚Äî –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤...
```

### –ü—Ä–∏–º–µ—Ä 2: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: /stardust-use --session xyz789abc --output ideas.md
–ü–æ–º–æ—â–Ω–∏–∫: ‚úÖ –ö–æ–Ω—Ç–µ–Ω—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ ideas.md
```

### –ü—Ä–∏–º–µ—Ä 3: –ü–æ—Ç–æ–∫–æ–≤—ã–π –≤—ã–≤–æ–¥
```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: /stardust-use --session xyz789abc --stream
–ü–æ–º–æ—â–Ω–∏–∫: ü§ñ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è... [–æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏]
```

## –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

| –¢–∏–ø –æ—à–∏–±–∫–∏ | –ü—Ä–∏—á–∏–Ω–∞ | –†–µ—à–µ–Ω–∏–µ |
|---------|------|----------|
| SESSION_NOT_FOUND | –°–µ–∞–Ω—Å –Ω–µ –Ω–∞–π–¥–µ–Ω | –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –≤ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ |
| SESSION_EXPIRED | –°–µ–∞–Ω—Å –∏—Å—Ç–µ–∫ | –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –≤ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ |
| AUTH_REQUIRED | –ù–µ –≤—ã–ø–æ–ª–Ω–µ–Ω –≤—Ö–æ–¥ | –í–æ–π–¥–∏—Ç–µ —á–µ—Ä–µ–∑ /stardust-auth |
| SUBSCRIPTION_REQUIRED | –¢—Ä–µ–±—É–µ—Ç—Å—è –ø–ª–∞—Ç–Ω–∞—è –ø–æ–¥–ø–∏—Å–∫–∞ | –û–±–Ω–æ–≤–∏—Ç–µ –ø–ª–∞–Ω –ø–æ–¥–ø–∏—Å–∫–∏ |
| RATE_LIMIT | –°–ª–∏—à–∫–æ–º —á–∞—Å—Ç—ã–µ –∑–∞–ø—Ä–æ—Å—ã | –ü–æ–¥–æ–∂–¥–∏—Ç–µ –∏ –ø–æ–≤—Ç–æ—Ä–∏—Ç–µ –ø–æ–ø—ã—Ç–∫—É |
| DECRYPT_FAILED | –û—à–∏–±–∫–∞ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∏ | –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–µ–∞–Ω—Å–∞ |

## –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç—å—é
```javascript
// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ WeakMap –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–∞–º—è—Ç—å—é
const promptCache = new WeakMap();

// –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø–∞–º—è—Ç–∏
const MAX_MEMORY = 50 * 1024 * 1024; // 50MB

// –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø–∞–º—è—Ç–∏
if (process.memoryUsage().heapUsed > MAX_MEMORY) {
  console.warn('–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–æ, –æ—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞...');
  global.gc && global.gc();
}
```

### –°—Ç—Ä–∞—Ç–µ–≥–∏—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è
- **–ù–µ –∫—ç—à–∏—Ä–æ–≤–∞—Ç—å Prompt** ‚Äî —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–µ Prompt –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –∫—ç—à–∏—Ä—É—é—Ç—Å—è.
- **–ö—ç—à–∏—Ä–æ–≤–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–µ–∞–Ω—Å–µ** ‚Äî –æ—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–µ–∞–Ω—Å–µ –∫—ç—à–∏—Ä—É–µ—Ç—Å—è –Ω–∞ 5 –º–∏–Ω—É—Ç.
- **–ö—ç—à–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–∫–µ–Ω –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏** ‚Äî —Ç–æ–∫–µ–Ω —à–∏—Ñ—Ä—É–µ—Ç—Å—è –∏ –∫—ç—à–∏—Ä—É–µ—Ç—Å—è –¥–æ –∏—Å—Ç–µ—á–µ–Ω–∏—è —Å—Ä–æ–∫–∞ –¥–µ–π—Å—Ç–≤–∏—è.

## –ê—É–¥–∏—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

–í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤ –∂—É—Ä–Ω–∞–ª –∞—É–¥–∏—Ç–∞ (–±–µ–∑ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö):
```json
{
  "action": "use_template",
  "userId": "user123",
  "templateId": "brainstorm",
  "sessionId": "xyz789abc",
  "timestamp": "2024-01-20T10:35:00Z",
  "success": true,
  "duration": 3500
}
```

## –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

1. **–ù–µ –ø—ã—Ç–∞–π—Ç–µ—Å—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å Prompt** ‚Äî —ç—Ç–æ –Ω–∞—Ä—É—à–∞–µ—Ç —É—Å–ª–æ–≤–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è.
2. **–ù–µ –ø–µ—Ä–µ–¥–∞–≤–∞–π—Ç–µ SessionID** ‚Äî –∫–∞–∂–¥—ã–π —Å–µ–∞–Ω—Å –ø—Ä–∏–≤—è–∑–∞–Ω –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é.
3. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–≤–æ–µ–≤—Ä–µ–º–µ–Ω–Ω–æ** ‚Äî —Å–µ–∞–Ω—Å—ã –∏—Å—Ç–µ–∫–∞—é—Ç —á–µ—Ä–µ–∑ 15 –º–∏–Ω—É—Ç.
4. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ä–∞–∑—É–º–Ω–æ** ‚Äî —Å–æ–±–ª—é–¥–∞–π—Ç–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —Å–∫–æ—Ä–æ—Å—Ç–∏.
5. **–ó–∞—â–∏—â–∞–π—Ç–µ —Å–≤–æ—é —É—á–µ—Ç–Ω—É—é –∑–∞–ø–∏—Å—å** ‚Äî –Ω–µ –ø–µ—Ä–µ–¥–∞–≤–∞–π—Ç–µ –¥–∞–Ω–Ω—ã–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏.

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

–ü–æ—Å–ª–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –≤—ã –º–æ–∂–µ—Ç–µ:
1. –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –¥–æ—Ä–∞–±–æ—Ç–∫—É —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞.
2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥—Ä—É–≥–∏–µ —à–∞–±–ª–æ–Ω—ã –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –±–æ–ª—å—à–µ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∏–¥–µ–π.
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å `/stardust-session` –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–µ–∞–Ω—Å–∞–º–∏.
4. –ü–æ—Å–µ—Ç–∏—Ç—å –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∏—Å—Ç–æ—Ä–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏.