---
description: Разработка технического плана реализации на основе спецификации истории
argument-hint: [технические предпочтения и выбор]
allowed-tools: Read(//stories/**/specification.md), Read(stories/**/specification.md), Read(//stories/**/creative-plan.md), Read(stories/**/creative-plan.md), Read(//plugins/**), Read(plugins/**), Write(//stories/**/creative-plan.md), Write(stories/**/creative-plan.md), Read(//memory/constitution.md), Read(memory/constitution.md), Bash(find:*), Bash(grep:*), Bash(*)
model: claude-sonnet-4-5-20250929
scripts:
  sh: .specify/scripts/bash/plan-story.sh
  ps: .specify/scripts/powershell/plan-story.ps1
---

На основе уточненных спецификаций истории разработайте конкретный план творческих и технических решений.

Ввод пользователя (выбор технологий и предпочтения):
$ARGUMENTS

## Цель

Преобразовать "что создавать" (спецификации) в "как создавать" (план). Это ключевой переход от требований к реализации.

## Шаги выполнения

### 1. Загрузка предварительных документов

Запустите `{SCRIPT}` для проверки и загрузки:
- Конституционный документ: `memory/novel-constitution.md`
- Файл спецификаций: `stories/*/specification.md`
- Записи уточнений (если `/clarify` был запущен)

Проверьте метки `[Требуется уточнение]` в спецификациях:
- Если существуют неуточненные ключевые решения, предложите сначала запустить `/clarify`.
- Или примите явное указание пользователя пропустить этот шаг.

### 2. Разработка плана творчества

Создайте файл `stories/*/creative-plan.md`, содержащий следующее:

#### 2.1 Выбор метода написания

На основе анализа спецификаций выберите наиболее подходящий метод написания:
- **Структура из трех актов**: подходит для линейного повествования, четкого начала, развития и завершения.
- **Путешествие героя**: подходит для историй о росте, приключениях.
- **Структура из семи точек**: подходит для историй с саспенсом, неожиданными поворотами.
- **Круг историй**: подходит для историй, ориентированных на персонажей, с психологической глубиной.
- **Смешанный метод**: использование разных методов для основной и второстепенных сюжетных линий.

Запишите обоснование выбора и способ применения.

#### 2.2 Структура глав

```markdown
## Структура глав

### Общий план
- Общее количество глав: [На основе целевого объема и длины глав]
- Длина главы: [2000-3000 слов/глава]
- Деление на тома: [Если применимо]

### Сопоставление структуры
[В соответствии с выбранным методом сопоставьте ключевые точки с конкретными главами]

### Дизайн ритма
- Завязка в начале: Глава [X]
- Первый кульминационный момент: Глава [X]
- Центральный поворот: Глава [X]
- Максимальный кризис: Глава [X]
- Финальный кульминационный момент: Глава [X]
```

#### 2.3 Система персонажей

```markdown
## Система персонажей

### Дизайн главного героя
- Начальное состояние: [Стартовая точка]
- Дуга развития: [Траектория изменений]
- Основной конфликт: [Внутренний vs Внешний]
- Ключевые точки трансформации: [Конкретные главы]

### Функции второстепенных персонажей
[Функциональное позиционирование и план появления каждого важного второстепенного персонажа]

### Сеть взаимоотношений
[Схема взаимоотношений персонажей и план их развития]
```

#### 2.4 Построение мира

```markdown
## Система мира

### Основные настройки
- Правила мира: [Физические/магические/технологические правила]
- Социальная структура: [Политическая/экономическая/культурная]
- Исторический фон: [Важные исторические события]

### План развития мира
- Первый уровень (начало): [Базовые настройки]
- Второй уровень (развитие): [Углубленные настройки]
- Третий уровень (кульминация): [Ключевые секреты]
```

#### 2.5 Технический дизайн сюжета

```markdown
## Технологии сюжета

### Путь нарастания конфликта
1. Первичный конфликт: [Личный уровень]
2. Вторичный конфликт: [Групповой уровень]
3. Третичный конфликт: [Мировой уровень]

### Создание саспенса
- Основной саспенс: [Пронизывает все произведение]
- Саспенс главы: [Завязка в каждой главе]
- Саспенс второстепенных линий: [Обогащает слои]

### Размещение зацепок
[Список зацепок и план их использования]
```

#### 2.6 Выбор техник повествования

```markdown
## Техники повествования

### Дизайн POV
- Тип точки зрения: [Первое/третье лицо]
- Ограничение точки зрения: [Всеведущий/ограниченный]
- Расстановка нескольких точек зрения: [Если применимо]

### Дизайн временной шкалы
- Основная временная линия: [Линейная/нелинейная]
- Вставки воспоминаний: [Стратегия использования]
- Параллельное повествование: [Если применимо]

### Ритм повествования
- Быстрые отрывки: [Действие/конфликт]
- Медленные отрывки: [Эмоции/описания]
- Изменение ритма: [Закономерности нарастания и спада]
```

### 3. Запись технических решений

Запишите все важные технические решения:
- **Решение**: Что выбрано
- **Причина**: Почему выбрано
- **Риски**: Возможные проблемы
- **План Б**: Альтернативные варианты

### 4. План обеспечения качества

```markdown
## Обеспечение качества

### Чек-лист самопроверки
- [ ] Проверка логической согласованности
- [ ] Обоснованность действий персонажей
- [ ] Самосогласованность мира
- [ ] Плавность ритма

### Узлы проверки
- Каждые 5 глав: мини-цикл проверки
- Каждый том: макро-цикл проверки
- Готовый текст: полная проверка
```

### 5. Управление рисками

Определите и разработайте стратегии реагирования:
- **Риски творчества**: Вдохновение, логика, ритм
- **Технические риски**: Сложность, согласованность
- **Временные риски**: График, баланс качества

### 6. Вывод и проверка

- Сохраните план в `stories/*/creative-plan.md`
- Проверьте соответствие плана принципам конституции
- Проверьте соответствие плана требованиям спецификаций
- Подсказка о следующем шаге: запуск `/tasks` для генерации задач

## Связь с другими командами

- **Ввод**: Спецификации из `/specify` + уточнения из `/clarify`
- **Вывод**: Основа для генерации задач командой `/tasks`
- **Проверка**: Используется командой `/analyze` для проверки соответствия реализации

## Примечания

### Технологии служат истории
- Все технические решения должны служить выражению истории
- Не гонитесь за техниками ради самих техник
- Сохраняйте гибкость плана

### Исполнимость
- План должен быть конкретным и выполнимым
- Избегайте чрезмерного идеализма
- Учитывайте реальные творческие возможности

### Итеративная оптимизация
- План может корректироваться в процессе работы
- Записывайте причины и последствия изменений
- Поддерживайте отслеживание версий

Помните: **Хороший план — половина успеха, но будьте готовы к корректировкам.**
---