```markdown
# Инициализация системы отслеживания

На основе созданного плана истории и структуры глав инициализируются все файлы данных отслеживания.

## Когда использовать

Выполните эту команду после завершения `/story` и `/outline`, перед началом написания.

## Процесс инициализации

1. **Чтение базовых данных**
   - Читает `stories/*/story.md` для получения сеттинга истории
   - Читает `stories/*/outline.md` для получения структуры глав
   - Читает `.specify/config.json` для получения метода письма

2. **Инициализация файлов отслеживания**

   **Важно**: Приоритетно читает спецификацию управления сюжетными линиями из пятой главы `specification.md` и заполняет ею файлы отслеживания.

   Создаёт или обновляет `spec/tracking/plot-tracker.json`:
   - Читает все определения сюжетных линий из `specification.md` раздела 5.1
   - Читает все точки пересечения из `specification.md` раздела 5.3
   - Читает все предзнаменования из `specification.md` раздела 5.4
   - Читает распределение сюжетных линий по главам из `creative-plan.md`
   - Устанавливает текущий статус (предполагается, что написание ещё не началось)

   **Структура `plot-tracker.json`**:
   ```json
   {
     "novel": "[Название истории из specification.md]",
     "lastUpdated": "[YYYY-MM-DD]",
     "currentState": {
       "chapter": 0,
       "volume": 1,
       "mainPlotStage": "[Начальный этап]"
     },
     "plotlines": {
       "main": {
         "name": "[Название основной линии]",
         "status": "active",
         "currentNode": "[Начальная точка]",
         "completedNodes": [],
         "upcomingNodes": "[Считать из точек пересечения и плана глав]"
       },
       "subplots": [
         {
           "id": "[Из 5.1, например PL-01]",
           "name": "[Название сюжетной линии]",
           "type": "[Основная линия/Побочная линия/Поддержка основной линии]",
           "priority": "[P0/P1/P2]",
           "status": "[active/dormant]",
           "plannedStart": "[Начальная глава]",
           "plannedEnd": "[Конечная глава]",
           "currentNode": "[Текущий узел]",
           "completedNodes": [],
           "upcomingNodes": "[Считать из таблицы точек пересечения]",
           "intersectionsWith": "[Считать соответствующие ID линий из таблицы пересечений 5.3]",
           "activeChapters": "[Считать из плана ритма 5.2]"
         }
       ]
     },
     "foreshadowing": [
       {
         "id": "[Из 5.4, например F-001]",
         "content": "[Содержание предзнаменования]",
         "planted": {"chapter": null, "description": "[Описание установки]"},
         "hints": [],
         "plannedReveal": {"chapter": "[Глава раскрытия]", "description": "[Способ раскрытия]"},
         "status": "planned",
         "importance": "[high/medium/low]",
         "relatedPlotlines": "[Список ID задействованных сюжетных линий]"
       }
     ],
     "intersections": [
       {
         "id": "[Из 5.3, например X-001]",
         "chapter": "[Глава пересечения]",
         "plotlines": "[Список ID задействованных сюжетных линий]",
         "content": "[Содержание пересечения]",
         "status": "upcoming",
         "impact": "[Ожидаемый эффект]"
       }
     ]
   }
   ```

   Создаёт или обновляет `spec/tracking/timeline.json`:
   - Устанавливает временные точки на основе плана глав
   - Отмечает важные временные события

   Создаёт или обновляет `spec/tracking/relationships.json`:
   - Извлекает начальные отношения из сеттинга персонажей
   - Устанавливает группировку по фракциям

   Создаёт или обновляет `spec/tracking/character-state.json`:
   - Инициализирует состояние персонажей
   - Устанавливает начальное местоположение

3. **Генерация отчёта отслеживания**
   Отображает результаты инициализации, подтверждая готовность системы отслеживания

## Интеллектуальная связь

- Автоматически устанавливает контрольные точки в соответствии с методом письма
- Путешествие героя: контрольные точки из 12 этапов
- Трёхчастная структура: точки поворота трёх актов
- Семиточечная структура: 7 ключевых узлов

После инициализации системы отслеживания эти данные будут автоматически обновляться в процессе написания.
```